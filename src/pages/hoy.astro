---
/**
 * P谩gina: C贸mo ha comido hoy
 * Muestra el estado de la comida del d铆a actual
 */
import Layout from '../layouts/Layout.astro';
import EstadoComida from '../components/EstadoComida.astro';

// TODO: Obtener datos reales de Supabase
// import { getSession, getEstudiantePorPadre, getRegistroHoy } from '../lib/supabase';

// Mock de datos para desarrollo
const estudianteMock = {
  nombre: 'Mar铆a',
  apellido: 'Gonz谩lez',
};

const registroMock = {
  fecha: new Date().toLocaleDateString('es-ES', { 
    weekday: 'long', 
    year: 'numeric', 
    month: 'long', 
    day: 'numeric' 
  }),
  estado: 'bien' as const,
  comentario: 'Ha probado todos los platos y ha repetido del segundo. Muy buena actitud en la mesa.',
  monitor_nombre: 'Ana Mart铆nez',
};

// TODO: Verificar sesi贸n y obtener datos reales
// const session = await getSession();
// if (!session) {
//   return Astro.redirect('/');
// }
// const estudiante = await getEstudiantePorPadre(session.user.id);
// const registro = await getRegistroHoy(estudiante.id);
---

<Layout 
  title="C贸mo ha comido hoy" 
  showNav={true} 
  currentPath="/hoy"
>
  <div class="max-w-2xl mx-auto px-4 py-6">
    <!-- Informaci贸n del estudiante -->
    <div class="mb-6">
      <div class="flex items-center gap-3 mb-2">
        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
          <span class="text-2xl"></span>
        </div>
        <div>
          <h2 class="text-lg font-semibold text-gray-900">
            {estudianteMock.nombre} {estudianteMock.apellido}
          </h2>
          <p class="text-sm text-gray-500 capitalize">
            {registroMock.fecha}
          </p>
        </div>
      </div>
    </div>

    <!-- Estado de la comida -->
    <EstadoComida 
      estado={registroMock.estado}
      comentario={registroMock.comentario}
    />

    <!-- Informaci贸n del monitor -->
    {registroMock.monitor_nombre && (
      <div class="mt-6 text-center">
        <p class="text-sm text-gray-500">
          Registrado por <span class="font-medium text-gray-700">{registroMock.monitor_nombre}</span>
        </p>
      </div>
    )}

    <!-- Informaci贸n adicional -->
    <div class="mt-8 bg-blue-50 border border-blue-100 rounded-lg p-4">
      <div class="flex gap-3">
        <svg class="w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <div class="text-sm text-blue-900">
          <p class="font-medium mb-1">驴Tienes alguna duda?</p>
          <p class="text-blue-800">
            Puedes contactar con el comedor escolar para m谩s informaci贸n sobre la alimentaci贸n de tu hijo.
          </p>
        </div>
      </div>
    </div>

    <!-- Ejemplo de otros estados (solo para desarrollo, eliminar en producci贸n) -->
    <div class="mt-8 pt-8 border-t border-gray-200">
      <p class="text-xs text-gray-400 mb-4 text-center">
        Ejemplos de otros estados (solo desarrollo)
      </p>
      <div class="space-y-4">
        <EstadoComida 
          estado="regular"
          comentario="Ha comido el primer plato completo, pero no ha querido probar el segundo."
        />
        <EstadoComida 
          estado="mal"
          comentario="Hoy no ten铆a mucho apetito. Ha probado un poco de cada plato."
        />
      </div>
    </div>
  </div>
</Layout>
